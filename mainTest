# Parameters
testTar="/home/ohadoz/Desktop/RansomwareDetection/TestData/tar/TestData.tar.gz"
testOutput="/home/ohadoz/Desktop/RansomwareDetection/TestData/output/"
testOutputDirectory="/home/ohadoz/Desktop/RansomwareDetection/TestData/output"
buildOutput="/home/ohadoz/Desktop/RansomwareDetection/src"
sandBox="/tmp/sandbox"

echo "Config:"
echo "Build output: $buildOutput"
echo "Test tar: $testTar"
echo "Test output: $testOutput"
echo "Sandbox: $sandbox"
sleep 5

echo " "

echo "Updating repository"
git pull
sleep 5

echo "Building project"
cd src
make
sleep 2

echo "Test data cleanup"
rm -rf $testOutputDirectory
sleep 2

echo "Create test data"
cd ..
mkdir $testOutput
tar -C $testOutput -zxf $testTar
sleep 2

echo "Start Ransomware Detection"
mkdir $sandbox
sudo umount $sandBox
cd $buildOutput
./RansomwareGateway $testOutput $sandBox &
sleep 2

echo "Running ransomwares"
cd ..


echo "Disabling Ransomware Detection"
sudo umount $sandBox
